"use strict";(self.webpackChunkevo_lua_github_io=self.webpackChunkevo_lua_github_io||[]).push([[61],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),m=o,f=p["".concat(l,".").concat(m)]||p[m]||d[m]||i;return n?a.createElement(f,r(r({ref:t},c),{},{components:n})):a.createElement(f,r({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var u=2;u<i;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},2185:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return d}});var a=n(7462),o=n(3366),i=(n(7294),n(3905)),r=["components"],s={},l="RFC: Code Conventions",u={unversionedId:"background-information/design/implemented/code-conventions",id:"background-information/design/implemented/code-conventions",title:"RFC: Code Conventions",description:"This document describes the rationale behind Evo's code conventions",source:"@site/docs/background-information/design/implemented/code-conventions.md",sourceDirName:"background-information/design/implemented",slug:"/background-information/design/implemented/code-conventions",permalink:"/docs/background-information/design/implemented/code-conventions",draft:!1,editUrl:"https://github.com/evo-lua/evo-lua.github.io/edit/main/docs/background-information/design/implemented/code-conventions.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"RFC: Ninja-based Builds",permalink:"/docs/background-information/design/implemented/build-system-rework"},next:{title:"RFC: Event Handling",permalink:"/docs/background-information/design/implemented/event-handling"}},c={},d=[{value:"Separate Styles for Lua and Native Components",id:"separate-styles-for-lua-and-native-components",level:2},{value:"Finding a Stylistic Vision",id:"finding-a-stylistic-vision",level:2},{value:"A Survey of Code Style Issues",id:"a-survey-of-code-style-issues",level:2},{value:"Tabs vs. Spaces",id:"tabs-vs-spaces",level:3},{value:"Capitalization Rules",id:"capitalization-rules",level:3},{value:"Semicolons",id:"semicolons",level:3},{value:"Magic Globals",id:"magic-globals",level:3},{value:"Enumerations and (Shared) Constants",id:"enumerations-and-shared-constants",level:3},{value:"Autoformat Wherever Possible",id:"autoformat-wherever-possible",level:2},{value:"By Royal Decree (TL;DR)",id:"by-royal-decree-tldr",level:2}],p={toc:d};function m(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"rfc-code-conventions"},"RFC: Code Conventions"),(0,i.kt)("p",null,"This document describes the rationale behind Evo's code conventions"),(0,i.kt)("h2",{id:"separate-styles-for-lua-and-native-components"},"Separate Styles for Lua and Native Components"),(0,i.kt)("p",null,"What is idiomatic in Lua may not be in C or C++, and vice versa. Additionally, low-level code often is written in a way that makes it more difficult to read and understand",(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1")),". Programmers working on a high-level of abstraction presumably have different expectations than those working with lower-level languages and concepts, so it seems reasonable to treat native code differently than Lua code, especially since much of the native libraries are provided by third parties",(0,i.kt)("sup",{parentName:"p",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2")),"."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("sup",{parentName:"em",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," I'm primarily referring to naming conventions, use of opaque abbreviations, lack of useful abstractions, lack of modularity, and other such issues unrelated to the syntax of the language itself (which may further add to the problem).")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("sup",{parentName:"em",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," The code written by library authors may follow arbitrary conventions that don't necessarily translate well to Lua.")),(0,i.kt)("h2",{id:"finding-a-stylistic-vision"},"Finding a Stylistic Vision"),(0,i.kt)("p",null,"But what styles should be adopted? Unfortunately, there is no one true way of writing C or C++, and definitely not Lua."),(0,i.kt)("p",null,"Let's first see what some of the existing conventions are, where they originate, and what the benefits and drawbacks are."),(0,i.kt)("h2",{id:"a-survey-of-code-style-issues"},"A Survey of Code Style Issues"),(0,i.kt)("h3",{id:"tabs-vs-spaces"},"Tabs vs. Spaces"),(0,i.kt)("p",null,"Here are some benefits of using tabs:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Semantically, the tab key is exactly what you want to use when indenting code"),(0,i.kt)("li",{parentName:"ul"},"It somewhat reduces file size on disk, at least for raw textual data"),(0,i.kt)("li",{parentName:"ul"},"The indentation size can be adjusted to provide a perfect experience for every developer")),(0,i.kt)("p",null,"And here are some benefits of using spaces:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"You get to train your fingers by pressing the space key twice as many times as would be required for pressing tabs"),(0,i.kt)("li",{parentName:"ul"},"You may be earning more money than those tab-indenting peasants (or so ",(0,i.kt)("a",{parentName:"li",href:"https://stackoverflow.blog/2017/06/15/developers-use-spaces-make-money-use-tabs/"},"this blog post half-jokingly claims"),")")),(0,i.kt)("p",null,"This is actually not a serious comparison (if you couldn't tell). I can't think of any real reasons to use spaces over tabs, so let's not. If someone disagrees, it is trivial to set up some tooling that automatically converts between the two."),(0,i.kt)("h3",{id:"capitalization-rules"},"Capitalization Rules"),(0,i.kt)("p",null,"I'm not an expert in Human-Computer-Interaction, but ",(0,i.kt)("a",{parentName:"p",href:"https://ux.stackexchange.com/questions/67454/how-does-capitalization-affect-readability"},"some cursory research"),' indicates that there may be benefits to adopting capitalization for "important" concepts, which hopefully would improve reading comprehension.'),(0,i.kt)("p",null,"So what are the drawbacks of using capitalized names? I can think of a few:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"You'll have to think even harder about whether to (and what to) capitalize"),(0,i.kt)("li",{parentName:"ul"},"If you overshoot the target, you may end up in the ",(0,i.kt)("a",{parentName:"li",href:"http://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html"},"Kingdom of Nouns")," - a terrible thought, indeed")),(0,i.kt)("p",null,"None of that seems enough of a drawback to eschew capital letters altogether, though."),(0,i.kt)("p",null,'For the documentation, I would consider title case more "authoritative" and sentence case more conversational.\nIt\'s probably acceptable to keep the ',(0,i.kt)("inlineCode",{parentName:"p"},"lowercase")," or even ",(0,i.kt)("inlineCode",{parentName:"p"},"snake_case")," for low-level code, especially the embedded libraries. And for the Lua (and C++) code I'd consider ",(0,i.kt)("inlineCode",{parentName:"p"},"camelCase")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"PascalCase")," to be a better convention that fits stylistically."),(0,i.kt)("h3",{id:"semicolons"},"Semicolons"),(0,i.kt)("p",null,"Some less civilized languages still cling to this ancient tradition. Thankfully, Lua has made them entirely optional."),(0,i.kt)("p",null,"Needless to say, they add very little (except visual clutter) and so there needn't be any in Evo's Lua codebase."),(0,i.kt)("h3",{id:"magic-globals"},"Magic Globals"),(0,i.kt)("p",null,"The global environment is a key concept in Lua's design, so painstakingly avoiding to use it seems silly. Primarily, the question is which nonstandard builtins and libraries should be exported globally. This number should be relatively small, though it needn't be zero, because there are some drawbacks to providing additional global exports:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Anything in the global environment may potentially collide with userland code"),(0,i.kt)("li",{parentName:"ul"},"If unused packages are preloaded and exported, resource usage increases (slightly)"),(0,i.kt)("li",{parentName:"ul"},"There is a much smaller benefit for frequently-accessed globals in places where it would usually be upvalued"),(0,i.kt)("li",{parentName:"ul"},"This is because typing one line to ",(0,i.kt)("inlineCode",{parentName:"li"},"require")," a module is mostly the same work as creating a local copy of a gobal")),(0,i.kt)("p",null,"However, there are certain areas where having packages or even just functions pre-exported really saves a lot of hassle:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"In test files, which won't benefit from local upvalues, assertions and testing primitives should be readily available"),(0,i.kt)("li",{parentName:"ul"},"Commonly-used functions that don't get upvalued anyway, such as formatted printing (",(0,i.kt)("inlineCode",{parentName:"li"},"printf"),")"),(0,i.kt)("li",{parentName:"ul"},"Cross-cutting concerns, such as functions for logging debug messages (e.g., ",(0,i.kt)("inlineCode",{parentName:"li"},"WARNING")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"DEBUG"),")")),(0,i.kt)("p",null,"I think it's perfectly alright to export those as globals, and I can't see there being enough of them to cause problems."),(0,i.kt)("h3",{id:"enumerations-and-shared-constants"},"Enumerations and (Shared) Constants"),(0,i.kt)("p",null,"I don't think anyone has ever invented a better convention, so let's just use the C-style ",(0,i.kt)("inlineCode",{parentName:"p"},"CAPITAL_CASE")," naming here."),(0,i.kt)("h2",{id:"autoformat-wherever-possible"},"Autoformat Wherever Possible"),(0,i.kt)("p",null,"Regardless of which style one considers ideal, it's clear that any and all formatting issues are moot with ",(0,i.kt)("inlineCode",{parentName:"p"},"clang-format"),"."),(0,i.kt)("p",null,"Changing the rules is trivial, so let's focus on the stylistic questions that can't be automated: Capitalization and globals."),(0,i.kt)("h2",{id:"by-royal-decree-tldr"},"By Royal Decree (TL;DR)"),(0,i.kt)("p",null,"I hereby declare the following conventions should be used:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Low-level bindings exposing embedded libraries use ",(0,i.kt)("inlineCode",{parentName:"li"},"snake_case"),", because that's what those libraries use as well"),(0,i.kt)("li",{parentName:"ul"},"C++ code uses ",(0,i.kt)("inlineCode",{parentName:"li"},"camelCase")," for variables and regular functions, but ",(0,i.kt)("inlineCode",{parentName:"li"},"PascalCase")," for objects, namespaces, etc."),(0,i.kt)("li",{parentName:"ul"},"Lua code uses ",(0,i.kt)("inlineCode",{parentName:"li"},"camelCase")," for regular functions or variables, but ",(0,i.kt)("inlineCode",{parentName:"li"},"PascalCase")," for objects and high-level APIs")),(0,i.kt)("p",null,"The specifics shall be published on a ",(0,i.kt)("a",{parentName:"p",href:"/docs/references/code-conventions"},"separate reference page")," posthaste. You may now leave this website, peasant.",(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," ",(0,i.kt)("em",{parentName:"p"},"Actually, I'm always open to changes if there are good reasons to use a different convention.")))}m.isMDXComponent=!0}}]);